2026-01-18 14:57:18,400 - __main__ - ERROR - Fatal error: run() got an unexpected keyword argument 'on_startup'
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/main.py", line 60, in main
    uvicorn.run(
    ~~~~~~~~~~~^
        app,
        ^^^^
    ...<5 lines>...
        on_startup=[startup] # Ensure startup function is called
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
TypeError: run() got an unexpected keyword argument 'on_startup'
2026-01-18 14:59:50,451 - __main__ - ERROR - Fatal error: [Errno 2] No such file or directory
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/main.py", line 63, in main
    uvicorn.run(
    ~~~~~~~~~~~^
        app,
        ^^^^
    ...<4 lines>...
        log_level="info"
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    ~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/usr/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
    ~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/config.py", line 421, in load
    self.ssl: ssl.SSLContext | None = create_ssl_context(
                                      ~~~~~~~~~~~~~~~~~~^
        keyfile=self.ssl_keyfile,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        ciphers=self.ssl_ciphers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/config.py", line 112, in create_ssl_context
    ctx.load_cert_chain(certfile, keyfile, get_password)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory
2026-01-18 15:02:31,632 - __main__ - ERROR - Fatal error: 'Settings' object has no attribute 'ssl_key'
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/main.py", line 67, in main
    ssl_keyfile=settings.ssl_key,
                ^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/pydantic/main.py", line 855, in __getattr__
    raise AttributeError(f'{type(self).__name__!r} object has no attribute {item!r}')
AttributeError: 'Settings' object has no attribute 'ssl_key'
2026-01-18 15:08:32,494 - __main__ - ERROR - Fatal error: [Errno 13] Permission denied
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/main.py", line 64, in main
    uvicorn.run(
    ~~~~~~~~~~~^
        app,
        ^^^^
    ...<4 lines>...
        log_level="info"
        ^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/main.py", line 587, in run
    server.run()
    ~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/server.py", line 62, in run
    return asyncio.run(self.serve(sockets=sockets))
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/usr/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "uvloop/loop.pyx", line 1518, in uvloop.loop.Loop.run_until_complete
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/server.py", line 69, in serve
    config.load()
    ~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/config.py", line 421, in load
    self.ssl: ssl.SSLContext | None = create_ssl_context(
                                      ~~~~~~~~~~~~~~~~~~^
        keyfile=self.ssl_keyfile,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<5 lines>...
        ciphers=self.ssl_ciphers,
        ^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/uvicorn/config.py", line 112, in create_ssl_context
    ctx.load_cert_chain(certfile, keyfile, get_password)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied
2026-01-18 15:11:00,420 - api.server - INFO - APT Defender API Server starting...
2026-01-18 15:11:00,420 - __main__ - INFO - ============================================================
2026-01-18 15:11:00,420 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 15:11:00,420 - __main__ - INFO - ============================================================
2026-01-18 15:11:00,421 - __main__ - INFO - Initializing database...
2026-01-18 15:27:10,316 - api.server - INFO - APT Defender API Server starting...
2026-01-18 15:27:10,317 - __main__ - INFO - ============================================================
2026-01-18 15:27:10,317 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 15:27:10,317 - __main__ - INFO - ============================================================
2026-01-18 15:27:10,317 - __main__ - INFO - Initializing database...
2026-01-18 15:27:10,323 - __main__ - INFO - Loading YARA rules...
2026-01-18 15:27:10,323 - __main__ - INFO - Starting background services...
2026-01-18 15:27:10,323 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 15:27:10,323 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 15:40:25,913 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 15:59:52,881 - api.server - INFO - APT Defender API Server starting...
2026-01-18 15:59:52,882 - __main__ - INFO - ============================================================
2026-01-18 15:59:52,882 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 15:59:52,882 - __main__ - INFO - ============================================================
2026-01-18 15:59:52,882 - __main__ - INFO - Initializing database...
2026-01-18 15:59:52,888 - __main__ - INFO - Loading YARA rules...
2026-01-18 15:59:52,888 - __main__ - INFO - Starting background services...
2026-01-18 15:59:52,888 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 15:59:52,888 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 16:02:59,274 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 16:04:16,158 - api.server - INFO - APT Defender API Server starting...
2026-01-18 16:04:16,158 - __main__ - INFO - ============================================================
2026-01-18 16:04:16,159 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 16:04:16,159 - __main__ - INFO - ============================================================
2026-01-18 16:04:16,159 - __main__ - INFO - Initializing database...
2026-01-18 16:04:16,164 - __main__ - INFO - Loading YARA rules...
2026-01-18 16:04:16,164 - __main__ - INFO - Starting background services...
2026-01-18 16:04:16,165 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 16:04:16,165 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 16:04:17,951 - api.server - ERROR - Unhandled exception: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 394, in connect
    await_only(connection),
    ~~~~~~~~~~^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 141, in _connect
    self._connection = await future
                       ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 106, in run
    result = function()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 401, in connector
    return sqlite3.connect(loc, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.OperationalError: unable to open database file

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 782, in app
    await route.handle(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 72, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/api/auth.py", line 209, in register
    result = await db.execute(select(User).where(User.email == user_in.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2448, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 394, in connect
    await_only(connection),
    ~~~~~~~~~~^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 141, in _connect
    self._connection = await future
                       ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 106, in run
    result = function()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 401, in connector
    return sqlite3.connect(loc, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-18 16:06:02,348 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 16:09:26,858 - api.server - INFO - APT Defender API Server starting...
2026-01-18 16:09:26,859 - __main__ - INFO - ============================================================
2026-01-18 16:09:26,859 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 16:09:26,859 - __main__ - INFO - ============================================================
2026-01-18 16:09:26,859 - __main__ - INFO - Loading YARA rules...
2026-01-18 16:09:26,859 - __main__ - INFO - Starting background services...
2026-01-18 16:09:26,859 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 16:09:26,860 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 16:09:30,093 - api.server - ERROR - Unhandled exception: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 394, in connect
    await_only(connection),
    ~~~~~~~~~~^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 141, in _connect
    self._connection = await future
                       ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 106, in run
    result = function()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 401, in connector
    return sqlite3.connect(loc, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlite3.OperationalError: unable to open database file

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 782, in app
    await route.handle(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 72, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/api/auth.py", line 209, in register
    result = await db.execute(select(User).where(User.email == user_in.email))
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/ext/asyncio/session.py", line 449, in execute
    result = await greenlet_spawn(
             ^^^^^^^^^^^^^^^^^^^^^
    ...<6 lines>...
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 201, in greenlet_spawn
    result = context.throw(*sys.exc_info())
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2351, in execute
    return self._execute_internal(
           ~~~~~~~~~~~~~~~~~~~~~~^
        statement,
        ^^^^^^^^^^
    ...<4 lines>...
        _add_event=_add_event,
        ^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2239, in _execute_internal
    conn = self._connection_for_bind(bind)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 2108, in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<string>", line 2, in _connection_for_bind
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/orm/session.py", line 1187, in _connection_for_bind
    conn = bind.connect()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3285, in connect
    return self._connection_cls(self)
           ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 145, in __init__
    Connection._handle_dbapi_exception_noconnection(
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^
        err, dialect, engine
        ^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 2448, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 143, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/base.py", line 3309, in raw_connection
    return self.pool.connect()
           ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 447, in connect
    return _ConnectionFairy._checkout(self)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 1264, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 711, in checkout
    rec = pool._do_get()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 177, in _do_get
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/impl.py", line 175, in _do_get
    return self._create_connection()
           ~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 388, in _create_connection
    return _ConnectionRecord(self)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 673, in __init__
    self.__connect()
    ~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 899, in __connect
    with util.safe_reraise():
         ~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/langhelpers.py", line 224, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/pool/base.py", line 895, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/create.py", line 661, in connect
    return dialect.connect(*cargs, **cparams)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/engine/default.py", line 630, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)  # type: ignore[no-any-return]  # NOQA: E501
           ~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py", line 394, in connect
    await_only(connection),
    ~~~~~~~~~~^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 141, in _connect
    self._connection = await future
                       ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 106, in run
    result = function()
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 401, in connector
    return sqlite3.connect(loc, **kwargs)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) unable to open database file
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-18 16:11:16,515 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 16:15:47,667 - api.server - INFO - APT Defender API Server starting...
2026-01-18 16:15:47,667 - __main__ - INFO - ============================================================
2026-01-18 16:15:47,668 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 16:15:47,668 - __main__ - INFO - ============================================================
2026-01-18 16:15:47,668 - __main__ - INFO - Loading YARA rules...
2026-01-18 16:15:47,668 - __main__ - INFO - Starting background services...
2026-01-18 16:15:47,669 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 16:15:47,669 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 16:15:53,511 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2026-01-18 16:15:53,523 - api.server - ERROR - Unhandled exception: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 782, in app
    await route.handle(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 72, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/api/auth.py", line 219, in register
    password_hash=hash_password(user_in.password),
                  ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/api/auth.py", line 100, in hash_password
    return pwd_context.hash(password)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/context.py", line 2258, in hash
    return record.hash(secret, **kwds)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 779, in hash
    self.checksum = self._calc_checksum(secret)
                    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 591, in _calc_checksum
    self._stub_requires_backend()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2254, in _stub_requires_backend
    cls.set_backend()
    ~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2156, in set_backend
    return owner.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2163, in set_backend
    return cls.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2188, in set_backend
    cls._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2311, in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2224, in _set_backend
    ok = loader(**kwds)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 626, in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 421, in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
       ~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 380, in detect_wrap_bug
    if verify(secret, bug_hash):
       ~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 792, in verify
    return consteq(self._calc_checksum(secret), chk)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 655, in _calc_checksum
    hash = _bcrypt.hashpw(secret, config)
ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2026-01-18 16:16:47,408 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 16:17:07,517 - api.server - INFO - APT Defender API Server starting...
2026-01-18 16:17:07,517 - __main__ - INFO - ============================================================
2026-01-18 16:17:07,517 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 16:17:07,517 - __main__ - INFO - ============================================================
2026-01-18 16:17:07,518 - __main__ - INFO - Loading YARA rules...
2026-01-18 16:17:07,518 - __main__ - INFO - Starting background services...
2026-01-18 16:17:07,518 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 16:17:07,518 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 16:17:11,561 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
2026-01-18 16:17:11,573 - api.server - ERROR - Unhandled exception: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 782, in app
    await route.handle(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 72, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/api/auth.py", line 219, in register
    password_hash=hash_password(user_in.password),
                  ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/api/auth.py", line 100, in hash_password
    return pwd_context.hash(password)
           ~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/context.py", line 2258, in hash
    return record.hash(secret, **kwds)
           ~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 779, in hash
    self.checksum = self._calc_checksum(secret)
                    ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 591, in _calc_checksum
    self._stub_requires_backend()
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2254, in _stub_requires_backend
    cls.set_backend()
    ~~~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2156, in set_backend
    return owner.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2163, in set_backend
    return cls.set_backend(name, dryrun=dryrun)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2188, in set_backend
    cls._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2311, in _set_backend
    super(SubclassBackendMixin, cls)._set_backend(name, dryrun)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 2224, in _set_backend
    ok = loader(**kwds)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 626, in _load_backend_mixin
    return mixin_cls._finalize_backend_mixin(name, dryrun)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 421, in _finalize_backend_mixin
    if detect_wrap_bug(IDENT_2A):
       ~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 380, in detect_wrap_bug
    if verify(secret, bug_hash):
       ~~~~~~^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/utils/handlers.py", line 792, in verify
    return consteq(self._calc_checksum(secret), chk)
                   ~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/passlib/handlers/bcrypt.py", line 655, in _calc_checksum
    hash = _bcrypt.hashpw(secret, config)
ValueError: password cannot be longer than 72 bytes, truncate manually if necessary (e.g. my_password[:72])
2026-01-18 16:17:16,147 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 16:20:49,214 - api.server - INFO - APT Defender API Server starting...
2026-01-18 16:20:49,215 - __main__ - INFO - ============================================================
2026-01-18 16:20:49,215 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 16:20:49,215 - __main__ - INFO - ============================================================
2026-01-18 16:20:49,215 - __main__ - INFO - Loading YARA rules...
2026-01-18 16:20:49,215 - __main__ - INFO - Starting background services...
2026-01-18 16:20:49,215 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 16:20:49,216 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 16:21:53,575 - api.server - ERROR - Unhandled exception: name 'func' is not defined
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/cors.py", line 83, in __call__
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 762, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 782, in app
    await route.handle(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/starlette/routing.py", line 72, in app
    response = await func(request)
               ^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 299, in app
    raise e
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 294, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        dependant=dependant, values=values, is_coroutine=is_coroutine
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/api/auth.py", line 228, in register
    role='admin' if (await db.execute(select(func.count(User.id)))).scalar() == 0 else 'user'
                                             ^^^^
NameError: name 'func' is not defined
2026-01-18 16:22:57,512 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 16:24:01,962 - api.server - INFO - APT Defender API Server starting...
2026-01-18 16:24:01,963 - __main__ - INFO - ============================================================
2026-01-18 16:24:01,963 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 16:24:01,963 - __main__ - INFO - ============================================================
2026-01-18 16:24:01,963 - __main__ - INFO - Loading YARA rules...
2026-01-18 16:24:01,963 - __main__ - INFO - Starting background services...
2026-01-18 16:24:01,963 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 16:24:01,964 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 16:27:59,206 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 16:45:16,657 - api.server - INFO - APT Defender API Server starting...
2026-01-18 16:45:16,658 - __main__ - INFO - ============================================================
2026-01-18 16:45:16,658 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 16:45:16,658 - __main__ - INFO - ============================================================
2026-01-18 16:45:16,658 - __main__ - INFO - Loading YARA rules...
2026-01-18 16:45:16,658 - __main__ - INFO - Starting background services...
2026-01-18 16:45:16,658 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 16:45:16,658 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 16:45:42,577 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 16:51:23,481 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 16:54:18,552 - api.server - INFO - APT Defender API Server starting...
2026-01-18 16:54:18,553 - __main__ - INFO - ============================================================
2026-01-18 16:54:18,553 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 16:54:18,553 - __main__ - INFO - ============================================================
2026-01-18 16:54:18,553 - __main__ - INFO - Loading YARA rules...
2026-01-18 16:54:18,553 - __main__ - INFO - Starting background services...
2026-01-18 16:54:18,553 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 16:54:18,553 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 17:02:40,548 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 17:08:27,308 - __main__ - ERROR - Fatal error: near "CREATE": syntax error
Traceback (most recent call last):
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/main.py", line 58, in main
    asyncio.run(init_database())
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.13/asyncio/runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "/usr/lib/python3.13/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "/usr/lib/python3.13/asyncio/base_events.py", line 725, in run_until_complete
    return future.result()
           ~~~~~~~~~~~~~^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/database/db.py", line 190, in init_database
    await db.executescript(schema_sql)
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 222, in executescript
    cursor = await self._execute(self._conn.executescript, sql_script)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 133, in _execute
    return await future
           ^^^^^^^^^^^^
  File "/home/apt/opt/dete/apt-defender-system/pi-agent/venv/lib/python3.13/site-packages/aiosqlite/core.py", line 106, in run
    result = function()
sqlite3.OperationalError: near "CREATE": syntax error
2026-01-18 17:22:27,327 - api.server - INFO - APT Defender API Server starting...
2026-01-18 17:22:27,327 - __main__ - INFO - ============================================================
2026-01-18 17:22:27,328 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 17:22:27,328 - __main__ - INFO - ============================================================
2026-01-18 17:22:27,328 - __main__ - INFO - Loading YARA rules...
2026-01-18 17:22:27,328 - __main__ - INFO - Starting background services...
2026-01-18 17:22:27,328 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 17:22:27,328 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 17:26:19,951 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 17:27:05,506 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 17:27:05,530 - api.auth - INFO - Registered new device: 1
2026-01-18 17:30:57,426 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 17:40:32,009 - api.server - INFO - APT Defender API Server starting...
2026-01-18 17:40:32,009 - __main__ - INFO - ============================================================
2026-01-18 17:40:32,010 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 17:40:32,010 - __main__ - INFO - ============================================================
2026-01-18 17:40:32,010 - __main__ - INFO - Loading YARA rules...
2026-01-18 17:40:32,010 - __main__ - INFO - Starting background services...
2026-01-18 17:40:32,010 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 17:40:32,010 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 17:42:30,772 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 17:42:30,792 - api.auth - INFO - Updated existing device: 1
2026-01-18 17:42:30,814 - api.auth - INFO - Linked device 1 to user 1
2026-01-18 17:49:04,283 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 17:56:54,813 - api.server - INFO - APT Defender API Server starting...
2026-01-18 17:56:54,813 - __main__ - INFO - ============================================================
2026-01-18 17:56:54,813 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 17:56:54,813 - __main__ - INFO - ============================================================
2026-01-18 17:56:54,814 - __main__ - INFO - Loading YARA rules...
2026-01-18 17:56:54,814 - __main__ - INFO - Starting background services...
2026-01-18 17:56:54,814 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 17:56:54,814 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 17:57:50,964 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 17:58:07,308 - api.routes.devices - ERROR - Failed to fetch processes from device 1: name 'settings' is not defined
2026-01-18 17:58:12,344 - api.routes.devices - ERROR - Failed to fetch connections from device 1: name 'settings' is not defined
2026-01-18 17:58:20,787 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:01:12,020 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 18:05:07,277 - api.server - INFO - APT Defender API Server starting...
2026-01-18 18:05:07,277 - __main__ - INFO - ============================================================
2026-01-18 18:05:07,278 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 18:05:07,278 - __main__ - INFO - ============================================================
2026-01-18 18:05:07,278 - __main__ - INFO - Loading YARA rules...
2026-01-18 18:05:07,278 - __main__ - INFO - Starting background services...
2026-01-18 18:05:07,278 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 18:05:07,278 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 18:05:51,074 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:05:59,988 - api.routes.devices - ERROR - Failed to fetch processes from device 1: name 'settings' is not defined
2026-01-18 18:06:05,650 - api.routes.devices - ERROR - Failed to fetch connections from device 1: name 'settings' is not defined
2026-01-18 18:07:27,309 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:08:08,155 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 18:14:56,712 - api.server - INFO - APT Defender API Server starting...
2026-01-18 18:14:56,712 - __main__ - INFO - ============================================================
2026-01-18 18:14:56,712 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 18:14:56,712 - __main__ - INFO - ============================================================
2026-01-18 18:14:56,712 - __main__ - INFO - Loading YARA rules...
2026-01-18 18:14:56,712 - __main__ - INFO - Starting background services...
2026-01-18 18:14:56,713 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 18:14:56,713 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 18:15:48,788 - api.routes.devices - WARNING - Device 1 unpair requested
2026-01-18 18:16:00,852 - api.routes.devices - WARNING - Device 1 unpair requested
2026-01-18 18:18:26,116 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 18:21:01,658 - api.server - INFO - APT Defender API Server starting...
2026-01-18 18:21:01,658 - __main__ - INFO - ============================================================
2026-01-18 18:21:01,658 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 18:21:01,658 - __main__ - INFO - ============================================================
2026-01-18 18:21:01,658 - __main__ - INFO - Loading YARA rules...
2026-01-18 18:21:01,659 - __main__ - INFO - Starting background services...
2026-01-18 18:21:01,659 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 18:21:01,659 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 18:22:06,225 - api.routes.devices - WARNING - Device 1 unpair requested
2026-01-18 18:22:14,212 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:23:37,076 - api.routes.devices - ERROR - Failed to fetch processes from device 1: 'Settings' object has no attribute 'ssl_certfile'
2026-01-18 18:23:40,797 - api.routes.devices - ERROR - Failed to fetch connections from device 1: 'Settings' object has no attribute 'ssl_certfile'
2026-01-18 18:25:05,185 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 18:25:05,204 - api.auth - INFO - Updated existing device: 1
2026-01-18 18:25:27,102 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 18:25:48,349 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:28:29,947 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:30:11,592 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:30:53,552 - api.routes.devices - WARNING - Device 1 unpair requested
2026-01-18 18:31:17,432 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:33:54,209 - api.routes.devices - INFO - Scan requested for device 1: full
2026-01-18 18:34:40,491 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 19:01:24,442 - api.server - INFO - APT Defender API Server starting...
2026-01-18 19:01:24,442 - __main__ - INFO - ============================================================
2026-01-18 19:01:24,442 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 19:01:24,442 - __main__ - INFO - ============================================================
2026-01-18 19:01:24,443 - __main__ - INFO - Loading YARA rules...
2026-01-18 19:01:24,443 - __main__ - INFO - Starting background services...
2026-01-18 19:01:24,443 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 19:01:24,443 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 19:02:49,303 - api.routes.devices - ERROR - Error getting scan status for device 1: (sqlite3.OperationalError) no such column: scans.total_files
[SQL: SELECT scans.id, scans.device_id, scans.started_at, scans.completed_at, scans.status, scans.total_files, scans.files_checked, scans.threats_found, scans.scan_type, scans.error_message 
FROM scans 
WHERE scans.device_id = ? ORDER BY scans.started_at DESC
 LIMIT ? OFFSET ?]
[parameters: (1, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-18 19:02:56,132 - api.routes.devices - INFO - User 1 deleted device 1
2026-01-18 19:03:42,728 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 19:03:42,757 - api.auth - INFO - Registered new device: 2
2026-01-18 19:03:42,768 - api.auth - INFO - Linked device 2 to user 1
2026-01-18 19:03:55,961 - api.routes.devices - ERROR - Error getting scan status for device 2: (sqlite3.OperationalError) no such column: scans.total_files
[SQL: SELECT scans.id, scans.device_id, scans.started_at, scans.completed_at, scans.status, scans.total_files, scans.files_checked, scans.threats_found, scans.scan_type, scans.error_message 
FROM scans 
WHERE scans.device_id = ? ORDER BY scans.started_at DESC
 LIMIT ? OFFSET ?]
[parameters: (2, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-18 19:03:57,249 - api.routes.devices - ERROR - Failed to trigger scan on device 2: module 'connector.helper_client' has no attribute 'HelperClient'
2026-01-18 19:03:59,134 - api.routes.devices - ERROR - Failed to trigger scan on device 2: module 'connector.helper_client' has no attribute 'HelperClient'
2026-01-18 19:08:52,440 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 19:14:50,696 - api.server - INFO - APT Defender API Server starting...
2026-01-18 19:14:50,696 - __main__ - INFO - ============================================================
2026-01-18 19:14:50,696 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 19:14:50,696 - __main__ - INFO - ============================================================
2026-01-18 19:14:50,697 - __main__ - INFO - Loading YARA rules...
2026-01-18 19:14:50,697 - __main__ - INFO - Starting background services...
2026-01-18 19:14:50,697 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 19:14:50,697 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 19:15:01,388 - api.routes.devices - ERROR - Failed to trigger scan on device 2: cannot import name 'HelperClient' from 'connector.helper_client' (/home/apt/opt/dete/apt-defender-system/pi-agent/connector/helper_client.py)
2026-01-18 19:15:49,070 - api.routes.devices - ERROR - Error getting scan status for device 2: (sqlite3.OperationalError) no such column: scans.total_files
[SQL: SELECT scans.id, scans.device_id, scans.started_at, scans.completed_at, scans.status, scans.total_files, scans.files_checked, scans.threats_found, scans.scan_type, scans.error_message 
FROM scans 
WHERE scans.device_id = ? ORDER BY scans.started_at DESC
 LIMIT ? OFFSET ?]
[parameters: (2, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-18 19:15:50,483 - api.routes.devices - ERROR - Failed to trigger scan on device 2: cannot import name 'HelperClient' from 'connector.helper_client' (/home/apt/opt/dete/apt-defender-system/pi-agent/connector/helper_client.py)
2026-01-18 19:18:27,696 - api.routes.devices - INFO - User 1 deleted device 2
2026-01-18 19:19:49,078 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 19:22:23,386 - api.server - INFO - APT Defender API Server starting...
2026-01-18 19:22:23,387 - __main__ - INFO - ============================================================
2026-01-18 19:22:23,387 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 19:22:23,387 - __main__ - INFO - ============================================================
2026-01-18 19:22:23,387 - __main__ - INFO - Loading YARA rules...
2026-01-18 19:22:23,387 - __main__ - INFO - Starting background services...
2026-01-18 19:22:23,387 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 19:22:23,388 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 19:24:03,371 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 19:24:17,477 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 19:25:07,595 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 19:25:16,286 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 19:25:47,942 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 19:27:14,640 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 19:31:26,890 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 19:33:53,365 - api.server - INFO - APT Defender API Server starting...
2026-01-18 19:33:53,366 - __main__ - INFO - ============================================================
2026-01-18 19:33:53,366 - __main__ - INFO - APT Defender Pi Agent Starting
2026-01-18 19:33:53,366 - __main__ - INFO - ============================================================
2026-01-18 19:33:53,366 - __main__ - INFO - Loading YARA rules...
2026-01-18 19:33:53,366 - __main__ - INFO - Starting background services...
2026-01-18 19:33:53,366 - __main__ - INFO - ✅ APT Defender Ready
2026-01-18 19:33:53,366 - __main__ - INFO - API listening on https://0.0.0.0:8443
2026-01-18 19:34:59,904 - api.auth - INFO - Device pairing request: Alfred_Biju (192.168.56.1)
2026-01-18 19:34:59,933 - api.auth - INFO - Registered new device: 3
2026-01-18 19:34:59,949 - api.auth - INFO - Linked device 3 to user 1
2026-01-18 19:35:12,830 - api.routes.devices - ERROR - Error getting scan status for device 3: (sqlite3.OperationalError) no such column: scans.total_files
[SQL: SELECT scans.id, scans.device_id, scans.started_at, scans.completed_at, scans.status, scans.total_files, scans.files_checked, scans.threats_found, scans.scan_type, scans.error_message 
FROM scans 
WHERE scans.device_id = ? ORDER BY scans.started_at DESC
 LIMIT ? OFFSET ?]
[parameters: (3, 1, 0)]
(Background on this error at: https://sqlalche.me/e/20/e3q8)
2026-01-18 19:35:14,171 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:35:14,274 - connector.helper_client - ERROR - Helper service connection error: [Errno 2] No such file or directory
2026-01-18 19:35:14,275 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Cannot reach device
2026-01-18 19:37:41,193 - api.server - INFO - APT Defender API Server shutting down...
2026-01-18 19:46:20,023 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:22,290 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:22,817 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:23,053 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:23,321 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:50,134 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:46:50,135 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:46:50,150 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:52,192 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:52,307 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:46:52,307 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:46:52,813 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:52,834 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:46:52,835 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:46:53,073 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:46:53,074 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:46:53,079 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:53,301 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:46:53,337 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:46:53,337 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:20,166 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:20,167 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:20,205 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:47:22,195 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:47:22,211 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:22,211 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:22,828 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:22,829 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:22,849 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:47:23,068 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:47:23,094 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:23,094 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:23,318 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:23,319 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:23,324 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 19:47:50,221 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:50,222 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:52,210 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:52,211 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:52,864 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:52,865 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:53,084 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:53,085 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 19:47:53,339 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 19:47:53,340 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 20:22:59,099 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 20:23:59,210 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 20:23:59,211 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 20:25:50,071 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 20:26:50,091 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://192.168.56.1:7890/v1/scan/start
2026-01-18 20:26:50,092 - api.routes.devices - ERROR - Failed to trigger scan on device 3: Device is not responding
2026-01-18 20:27:42,466 - api.routes.devices - INFO - User 1 deleted device 3
2026-01-18 20:30:13,803 - api.auth - INFO - Device pairing request: Alfred_Biju (10.133.103.45)
2026-01-18 20:30:13,830 - api.auth - INFO - Registered new device: 4
2026-01-18 20:30:13,840 - api.auth - INFO - Linked device 4 to user 1
2026-01-18 20:30:25,664 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 20:31:25,679 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://10.133.103.45:7890/v1/scan/start
2026-01-18 20:31:25,679 - api.routes.devices - ERROR - Failed to trigger scan on device 4: Device is not responding
2026-01-18 20:33:14,042 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 20:34:14,056 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://10.133.103.45:7890/v1/network/connections
2026-01-18 20:34:14,056 - api.routes.devices - ERROR - Failed to fetch connections from device 4: Device is not responding
2026-01-18 20:37:08,718 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-18 20:38:08,734 - connector.helper_client - ERROR - Timeout connecting to Helper service: https://10.133.103.45:7890/v1/processes
2026-01-18 20:38:08,735 - api.routes.devices - ERROR - Failed to fetch processes from device 4: Device is not responding
2026-01-18 20:38:21,342 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-19 17:53:39,154 - api.routes.devices - INFO - User 1 deleted device 4
2026-01-19 17:54:18,245 - api.auth - INFO - Device pairing request: Alfred_Biju (10.232.50.45)
2026-01-19 17:54:18,272 - api.auth - INFO - Registered new device: 5
2026-01-19 17:54:18,282 - api.auth - INFO - Linked device 5 to user 1
2026-01-19 17:54:42,768 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-19 17:54:42,987 - connector.helper_client - ERROR - Helper service connection error: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-01-19 17:54:42,988 - api.routes.devices - ERROR - Failed to trigger scan on device 5: Cannot reach device
2026-01-19 17:54:55,924 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-19 17:54:56,015 - connector.helper_client - ERROR - Helper service connection error: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-01-19 17:54:56,016 - api.routes.devices - ERROR - Failed to trigger scan on device 5: Cannot reach device
2026-01-19 17:55:39,157 - api.routes.devices - INFO - User 1 deleted device 5
2026-01-19 17:59:00,818 - api.auth - INFO - Device pairing request: Alfred_Biju (10.232.50.45)
2026-01-19 17:59:00,832 - api.auth - INFO - Registered new device: 6
2026-01-19 17:59:00,840 - api.auth - INFO - Linked device 6 to user 1
2026-01-19 17:59:09,864 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-19 17:59:09,964 - connector.helper_client - ERROR - Helper service connection error: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-01-19 17:59:09,965 - api.routes.devices - ERROR - Failed to trigger scan on device 6: Cannot reach device
2026-01-19 18:04:57,770 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-19 18:04:58,207 - connector.helper_client - ERROR - Helper service connection error: SSLError: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-01-19 18:04:58,207 - api.routes.devices - ERROR - Failed to trigger scan on device 6: Cannot reach device: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-01-19 18:14:58,958 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-19 18:14:59,071 - connector.helper_client - ERROR - Helper service connection error: SSLError: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-01-19 18:14:59,071 - api.routes.devices - ERROR - Failed to trigger scan on device 6: Cannot reach device: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-01-19 18:27:52,014 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-19 18:27:52,246 - connector.helper_client - ERROR - Helper service connection error: SSLError: [SSL: TLSV13_ALERT_CERTIFICATE_REQUIRED] tlsv13 alert certificate required (_ssl.c:2649)
2026-01-19 18:27:52,247 - api.routes.devices - ERROR - Failed to trigger scan on device 6: Cannot reach device: [SSL: TLSV13_ALERT_CERTIFICATE_REQUIRED] tlsv13 alert certificate required (_ssl.c:2649)
2026-01-19 18:28:00,980 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-01-19 18:28:01,019 - connector.helper_client - ERROR - Helper service connection error: SSLError: [SSL: TLSV13_ALERT_CERTIFICATE_REQUIRED] tlsv13 alert certificate required (_ssl.c:2649)
2026-01-19 18:28:01,020 - api.routes.devices - ERROR - Failed to trigger scan on device 6: Cannot reach device: [SSL: TLSV13_ALERT_CERTIFICATE_REQUIRED] tlsv13 alert certificate required (_ssl.c:2649)
2026-02-04 14:24:38,766 - api.routes.devices - INFO - User 1 deleted device 6
2026-02-04 14:25:07,790 - api.auth - INFO - Device pairing request: Alfred_Biju (10.168.208.45)
2026-02-04 14:25:07,815 - api.auth - INFO - Registered new device: 7
2026-02-04 14:25:07,824 - api.auth - INFO - Linked device 7 to user 1
2026-02-04 14:25:18,995 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-02-04 14:25:19,476 - connector.helper_client - ERROR - Helper service connection error: SSLError: [SSL: TLSV13_ALERT_CERTIFICATE_REQUIRED] tlsv13 alert certificate required (_ssl.c:2649)
2026-02-04 14:25:19,477 - api.routes.devices - ERROR - Failed to trigger scan on device 7: Cannot reach device: [SSL: TLSV13_ALERT_CERTIFICATE_REQUIRED] tlsv13 alert certificate required (_ssl.c:2649)
2026-02-04 14:56:01,491 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-02-04 14:56:01,662 - connector.helper_client - ERROR - Helper service connection error: SSLError: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-02-04 14:56:01,662 - api.routes.devices - ERROR - Failed to trigger scan on device 7: Cannot reach device: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-02-04 14:58:14,959 - api.routes.devices - INFO - Successfully imported HelperClient via standard import
2026-02-04 14:58:15,048 - connector.helper_client - ERROR - Helper service connection error: SSLError: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
2026-02-04 14:58:15,049 - api.routes.devices - ERROR - Failed to trigger scan on device 7: Cannot reach device: [SSL: TLSV1_ALERT_UNKNOWN_CA] tlsv1 alert unknown ca (_ssl.c:2649)
